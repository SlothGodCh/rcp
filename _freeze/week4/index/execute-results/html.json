{
  "hash": "c2b4caa9bc8e25a61952bb2dbee7f09d",
  "result": {
    "engine": "knitr",
    "markdown": "---\npagetitle: \"ETC5513: Reproducible and Collaborative Practices\"\nsubtitle: \"Reproducible reporting using Quarto, git and GitHub\"\nauthor: \"Michael Lydeamore\"\nemail: \"michael.lydeamore@monash.edu\"\ndate: \"Week 4\"\ndepartment: \"Department of Econometrics and Business Statistics\"\nunit-url: \"rcp.numbat.space\"\nfooter: \"ETC5513 Week 4\"\nformat: \n  revealjs:\n    logo: images/monash-stacked-blue-rgb-transparent.png\n    slide-number: c\n    multiplex: false\n    theme: ../assets/monash.scss\n    show-slide-number: all\n    show-notes: false\n    controls: true\n    width: 1280\n    height: 750\n    css: [../assets/tachyons-addon.css, ../assets/custom.css, ../assets/lecture-01.css]\n    include-after-body: \"../assets/after-body.html\"\n    chalkboard:\n      boardmarker-width: 5\n      buttons: true\nexecute:\n  echo: true\n---\n\n\n\n\n\n\n## <br>[ETC5513: Reproducible and Collaborative Practices]{.monash-blue .title} {#etc5513-title background-image=\"images/bg-01.png\"}\n\n### Reproducible reporting using Quarto, git and GitHub\n\nLecturer: *Michael Lydeamore*\n\nDepartment of Econometrics and Business Statistics\n\n::: tl\n<br>\n\n<ul class=\"fa-ul\">\n\n<li>\n\n[<i class=\"fas fa-envelope\"></i>]{.fa-li}michael.lydeamore@monash.edu\n\n</li>\n\n<li>\n\n[<i class=\"fas fa-calendar-alt\"></i>]{.fa-li} Week 4\n\n</li>\n\n<li>\n\n[<i class=\"fa-solid fa-globe\"></i>]{.fa-li}<a href=\"rcp.numbat.space\">rcp.numbat.space</a>\n\n</li>\n\n</ul>\n\n<br>\n:::\n\n## Open Frame\n\n![](images/kelly-sikkema-mdADGzyXCVE-unsplash.jpg){fig-align=\"center\"}\n\n## Recap\n\n1. Motivation for version control\n2. Git\n3. Introduction to command line\n5. Github\n6. Integration between Github and Rstudio\n7. Workflow for using version control\n\n## Today's plan {#aim}\n\n::: {.callout-important}\n\n## Aim\nLearning more on creating reproducible reports:\n\n* Referencing\n* Quarto books\n* CSS files\n\nMore on Git:\n\n* Create and delete branches\n* Merge branches\n\nSolving git conflicts:\n:::\n\n\n## Connecting the dots\n\nSo far:\n\n- Learned to create basic reproducible reports using R \n- Learned how to connect our reproducible reports to Git and GitHub (version control)\n\n::: {.fragment}\nNext:\n\n- Need to learn how to make \"professional reports\" not only on html but also in pdf\n- How to collaborate on projects with other colleagues\n- Learn how to solve issues on GitHub\n:::\n\n## Displaying figures\n\nOptions inside the R code chunks:\n\n- `fig-align`: Controls the alignment of figures in the report default, center, left, or right\n- `fig-cap`: Captions. `fig-cap: \"My amazing graph.\"`\n- `fig-height`, `fig-width`: Size of the figure in inches\n- `height`, `width`: Size of your plot in the final file. For example `width = \"50%\"` which means half of the width of the image container (if the image is directly contained by a page instead of a child element of the page, that means half of the page width).\n\n\n[More on these controls here](https://quarto.org/docs/authoring/figures.html)\n\n## Inserting figures\n\nUsing Markdown syntax:\n\n```\n![Caption](path-to-image-here){fig-align=\"center\"}\n```\n\nUsing the `knitr` package:\n\n```{{r}}\n#| out-width: \"80%\"\n#| echo: false\nknitr::include_graphics(\"figs/insert_fig.png\")\n```\n\n## Setting up global options for our report\n\nGlobal options are those that [are applied to the entire document]{.monash-green2}.\n\n![](images/setup.png){fig-align=\"center\"}\n\n**Best is to add this R code chunk at the beginning of the document before the libraries R code chunk.**\n\nThey can be overwritten by the individual R code chunk options!\n\n[Knitr reference guide here](https://yihui.org/knitr/options/#plots)\n\n\n## Quarto and referencing\n\nQuarto automatically includes referencing information that used to be part of the [`bookdown`](https://bookdown.org/yihui/bookdown/) package. It's one of the many advantages of moving to Quarto over RMarkdown.\n\nIf you've used Bookdown before, just note that you no longer need to swap output formats for references to work.\n\n## Including referencing and keeping figures {.smaller}\n\n```{{yaml}}\ntitle: \"My Report\"\nauthor: \"Patricia Men√©ndez\"\noutput:\n  html: default    \n```\n  \n- Inside a folder called `filename_files`, figures will saved in a subfolder called `figure-html` (or appropriate document type) be named using the R code chunk names ( remember to name your R code chunks!)\n- Alternatively, we can add the following option into your YAML options:  \n\n```{{yaml}}\nknitr:\n  opts_chunk: \n    fig.path: Images/\n```\n\n**This will create a new folder called Images and will place all the figures inside.**\n\n## Figure referencing\n\nTo reference figures, we have to include a `label` and a `fig-cap`. For example,\n\n```{{r}}\n#| label: fig-scatterplot\n#| fig-cap: \"Normalised mileage of cars. Positive values represent above average mileage, negative values indicate negative mileage\"\n#| eval: false\n\ndata(\"mtcars\")  # load data\nmtcars$`car name` <- rownames(mtcars)  # create new column for car names\nmtcars$mpg_z <- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)  # compute normalized mpg\nmtcars$mpg_type <- ifelse(mtcars$mpg_z < 0, \"below\", \"above\")  # above / below avg flag\nmtcars <- mtcars[order(mtcars$mpg_z), ]  # sort\nmtcars$`car name` <- factor(mtcars$`car name`, levels = mtcars$`car name`)  # convert to factor to retain sorted order in plot.\n\n# Diverging Barcharts\nggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + \n  geom_bar(stat='identity', aes(fill=mpg_type), width=.5)  +\n  scale_fill_manual(name=\"Mileage\", \n                    labels = c(\"Above Average\", \"Below Average\"), \n                    values = c(\"above\"=\"#00ba38\", \"below\"=\"#f8766d\")) + \n  labs(subtitle=\"Normalised mileage from 'mtcars'\", \n       title= \"Diverging Bars\", x=\"Normalised mileage\", y=\"Car Name\") + \n  coord_flip()\n```\n\n## Figure referencing\n\n::: {.columns}\n::: {.column width='50%'}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Normalised mileage of cars. Positive values represent above average mileage, negative values indicate negative mileage](images/index.rmarkdown/fig-scatterplot1-1.png){#fig-scatterplot1 fig-align='center' width=75% height=75%}\n:::\n:::\n\n\n\n:::\n::: {.column width='50%'}\nCode:\n```\n@fig-scatterplot shows the normalised miles per gallon of a variety of makes of car.\n```\n\nOutput:\n\n@fig-scatterplot1 shows the normalised miles per gallon of a variety of makes of car.\n:::\n:::\n\n## Referencing a table {.scrollable}\n\nCiting a table follows the same syntax:\n\n```{{r}}\n#| label: tbl-summarytable\n#| tbl-cap: Summary of the dataset\n\nkable(head(mtcars))\n```\n\n\n\n\n\n::: {#tbl-summarytable1 .cell layout-align=\"center\" tbl-cap='Summary of the dataset'}\n::: {.cell-output-display}\n\n\n|                    |  mpg| cyl| disp|  hp|\n|:-------------------|----:|---:|----:|---:|\n|Cadillac Fleetwood  | 10.4|   8|  472| 205|\n|Lincoln Continental | 10.4|   8|  460| 215|\n|Camaro Z28          | 13.3|   8|  350| 245|\n|Duster 360          | 14.3|   8|  360| 245|\n|Chrysler Imperial   | 14.7|   8|  440| 230|\n|Maserati Bora       | 15.0|   8|  301| 335|\n\n\n:::\n:::\n\n\n\n\n## Referencing a table\n\nIn text:\n\n```\nWe can see the results in @tbl-summarytable\n```\n\nOutput:\n\nWe can see the results in @tbl-summarytable1\n\n::: {.callout-warning}\nIn order for a table to be cross-referenceable, it's label must start with with `tbl-`.\n:::\n\n\n## Referencing a table\n\n- Remember to create a table we need to organize our data in a data frame or a tibble\n- We can use the `kable` function from the [`kableExtra`](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) package.\n\nNote that we don't have to add the caption inside `kable`, we can use a chunk option. But the functional form will still work.\n\n## Referencing a section \n\nTo reference a section, use `@sec-label`, and add the `#sec-` identifier to the heading. For example:\n\n```\n## Introduction {#sec-introduction}\n```\n\nwhich we would then reference with `@sec-introduction`.\n\nNote that for this to work, we need to set `number-sections: true` in the YAML, as sections are only referred to by numbers.\n\n# Referencing Demo\n\n\n## Html reports templates\n\n\n- Templates can be modified by changing YAML options\n- There are lots of available Quqarto templates \n- YAML can be further modify by using css files. More info [here](https://geomoer.github.io/moer-base-r/unit99/sl03_css.html).\n\nLet's have a look at an example.\n\n# Let's learn more about Git\n\n\n## Recap {.smaller}\n \n-  `git clone` is used to target an existing repository and create a clone, or copy of the target repository.\n-  `git pull` is used to fetch and download content from a remote repository and immediately update the local repository to match that content.\n-  `git status` displays the state of the working directory and the staging area\n-  `git add file_name`  adds a change in the working directory to the staging area\n-  `git commit -m \"Message\"` (m = message for commit. The git commit is used to create a snapshot of the staged changes along a timeline of a Git projects history.)\n-  `git push origin branch name` is used to upload local repository content to a remote repository. \n  \n## Branching {.smaller}\n\n\nEach repository has one default branch, and can have multiple other branches. Branching is a great feature of version control!\n\n::: {.columns}\n::: {.column width='50%'}\n- It allows you to duplicate your existing repository\n- Use a branch to isolate development work without affecting other branches in the repository\n- Modification in a branch can be merged into your project.\n:::\n::: {.column width='50%'}\n![](images/git_tree1.jpg){fig-align=\"center\"}\n:::\n:::\n\nBranching is particularly important with Git as it is the mechanism that is used when you are collaborating with other researchers/data scientists.\n\n## HEAD\n\n`HEAD` is a pointer that Git uses to reference the current snapshot that we are looking at.\n\n![](images/gitsnapshots1.png){fig-align=\"center\"}\n\n## Creating branches from GitHub\n\nYou can create branches directly on GitHub. More info [here](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-and-deleting-branches-within-your-repository)\n\n![](images/GitHub_newbranch.png){fig-align=\"center\"}\n\n## Creating branches on GitHub\n\n![](images/branch_location.png){fig-align=\"center\"}\n\n## Deleting branches from GitHub\n\nYou can also delete branches directly on GitHub\n\n![](images/delete-branch.png){fig-align=\"center\"}\n\n## CLI\n\n![](images/shell.png){fig-align=\"center\"}\n\nAs you get more comfortable with git, you might find this a bit slow and tedious. \n\n[We will be using our command line interface/Terminal or Git Bash to create and move across branches.]{.monash-green2}\n\n\n## Create branches using the Terminal/Shell/CLI\n\nWe use the `git branch` and `git switch` commands.\n\n- `git branch` show us the branches we have in our repo and marks our current branch with `*`\n- `git branch newbranch_name` creates a new branch but does not move the `HEAD` of the repo there.\n- `git switch newbranch_name` moves the `HEAD` to `newbranch_name`\n\n## Git `HEAD` and `switch`\n\nHow does Git know what branch you‚Äôre currently on?\n\nBy using the pointer: `HEAD`. In Git, this is a pointer to the local branch you are currently on. \n\nInternally, the `git switch` command  updates the `HEAD` to point to either the specified branch or commit. \n\n## Another way to create and switch branches\nUsing the `switch` command\n\n- `git switch -c newbranch_name` creates a new branch and moves the repo `HEAD` to this branch\n- You can confirm it by using `git branch` to see in which branch you are currently in\n- Checking out a branch updates the files in the working directory to match the version stored in that branch\n- It tells Git to record all new commits on that branch.\n\n## Updating those new branches in the remote repo in GitHub\n- We can just update the newly created branch into GitHub with:\n\n`git push origin newbranch_name`\n\nAlternatively if we had files or changes added into that branch:\n- `git add .` (adding all the modified files into the staging area)\n- `git commit -m \"Updating new newbranch_name\"`\n- `git push origin newbranch_name`\n\n## Merging branches\n\n- `git checkout main`: First move to the branch we want to move content into\n- `git merge newbranch_name -m \"Merging branches\"`\n- `git push origin main` to update the remote repository\n\nRemember, we can use `git status` to check the status of our repo at any time.\n\n![](images/branches.png){fig-align=\"center\"}\n\n# Avoiding confusion when creating branches\n\n![](images/branches.png){fig-align=\"center\"}\n\n- Make sure you know where your branch is starting from \n- Branches of branches are, in general, not a good idea\n\n## Check out before creating new branch\n\n[It is essential to `git switch` before creating a new branch.]{.monash-green2}\n\nIf the branch where you are currently working was already merged with the main branch you'll need to undo almost all the changes from the old branch that did not make it into the main branch. \n\nReason:  all the old changes from that branch will appear as new changes in combination with the changes that are actually new.\n\nIt is fixable but a mess that you want to avoid!\n\n::: {.callout-caution}\nDon't create branches from a branch that is not the main branch unless you are deliberately doing it\n:::\n\n# Deleting branches using CLI\n\nTo delete a branch from your local repository:\n\n- `git branch -a`: list all the branches\n- `git checkout main`: Move to `main` branch\n- `git branch -d Name_of_branch`: Delete unwanted branch\n\n::: {.callout-caution}\nYou cannot delete a branch if your HEAD is on that branch\n:::\n\n![](images/GDE){fig-align=\"center\"}\n\n## Deleting branches using CLI\n\nTo delete a branch from your remote repository (GitHub):\n\n`git push origin --delete Name_of_branch`\n\n![](images/sharing.jpg){fig-align=\"center\"}\n\n\n## More on Branching {.smaller}\n\nImagine that you are working on your local repository and a collaborator has created a new branch in your remote repo.\n\nYou are currently working on your local repo and want to have a look at the new branch. That means that the local repo and your remote repo have [diverged]{.monash-green2}. \n\nThat is, both the local and remote repositories are **not currently synchronized.**\n\n\n- To synchronize your work: `git fetch origin`\n- `git fetch origin` looks where `origin` is and fetches any data from it that you don‚Äôt yet have.\n- It also updates your local database repo (if it can), moving your origin/main pointer (`HEAD`) to its new, more up-to-date position.\n\n\n## About remotes\n\nNote: If the git repo contains more than one [remote]{.monash-green2}, such as [origin]{.monash-green2} and [upstream]{.monash-green2}, \n`git fetch` will fetch all the changes from all of the remotes.\n\n`git fetch origin` will only fetch the changes from remote origin\n\n## Fetch workflow {.smaller}\n\n1. `git fetch` updates all remote branches\n2. Good practice to check branches available for checkout\n3. Make a local working copy of the branch\n\n### Workflow\n\n- `git remote` (The git remote command lets you create, view, and delete connections to remote repositories.)\n- `git fetch origin`:  fetch the changes from remote origin (Fetching is what you do when you want to see what everybody else has been working on in the remote repo)\n- `git branch -a` shows all the branches available in the local repository +  all the branches fetched from the remote. \n\nThe branches fetched from the remote origin would be preceded by `remotes/origin/`\n\n## Etiquette for working on someone else branch\n\n- To work on someone‚Äôs branch, make a local copy of it\n- Work on your local branch (new branch)\n- Then push that new branch to the remote repository\n \n\nTo do that:\n-  First make sure you are working in that branch in your local repo: `git branch -a`\n- Add changes into the staging area, commit and push changes to the corresponding branch into the remote repository: `git add files`, `git commit -m \"Message\"`, `git push origin name-of-the-branch`\n\n![](images/branches.png){fig-align=\"center\"}\n\n## How to go back to your previous branch? {.smaller}\n\n- `git checkout branchname`\n\nImagine that you have two branches:\n\n- main\n- Alternative_analysis\n   \nTo check in which branch you are currently\n\n* `git branch` or `git branch -a`, you will see an `*` to let you in which branch the `HEAD` of your repository currently is.   \n\nTo go back to main branch (assuming that you were in there): `git checkout main`\n\n# Merging diverging branches\n\n![](images/mergingbranches1.png){fig-align=\"center\"}\n\n![](images/mergingbranches2.png){fig-align=\"center\"}\n\nResource [here](https://www.atlassian.com/git/tutorials/using-branches/git-merge).\n\n## Merging branches sucessfully\n\nSuppose we have two branches: `main` and `new_development` and our goal is to bring changes from the branch `new_development` into our `main` branch:\n\n1. For merging, go to `main` branch: `git checkout main`\n2. `git merge new_development`\n3. `git push origin main`\n3. This will incorporate the changes made in the branch new_development into the main branch.\n\nIf those steps are successful  your `new_development` branch will be fully integrated within the main branch.\n\n## Merging branches with conflicts\n\nHowever, it is possible that  Git will not be able to automatically resolve some [conflicts]{.monash-green2}, \n\n\n```\n# Auto-merging index.html\n# CONFLICT (content): Merge conflict in index.html\n# Automatic merge failed; fix conflicts and then commit the result.\n```\n\n::: {.callout-important}\nDo not panic.\n:::\n\nNo-one likes merge conflicts but they happen, and are fixable.\n\n## You will need to resolve the conflicts\n\nYou will have to resolve them **manually**. \n\nThis normally happens when two branches have the same file but with two different versions of the file. In that case Git is not able to figure out which version to use and is asking you to resolve the conflict.\n\n## Resolving merging conflicts\n\nFirst, [figure out which files are affected by the conflict]{.monash-green2}:\n\n::: {.fragment}\n`git status`\n\n```\ngit status\n# On branch main\n# You have unmerged paths.\n#   (fix conflicts and run \"git commit\")\n# \n# Unmerged paths:\n#   (use \"git add <file>...\" to mark resolution)\n# \n#     both modified:      example.Rmd\n# \n# no changes added to commit (use \"git add\" and/or \"git commit -a\")\n```\n\n:::\n\n## Resolving the conflict\n\n- Open the file with a text editor\n- Go to the lines which are marked with\n\n`<<<<<<`{.red}, `======`{.red} ,  and `>>>>>>`{.red}\n\nEdit the file\n\n- `git add filename`\n- `git commit -m \"Message\"`\n- `git push origin main`\n\n## Resolving conflicts\n\nWhen you open the conflict file in a **text editor such as Rstudio**, you will see the conflicted part marked like this:\n\n```\n/* code unaffected by conflict */\n<<<<<<< HEAD\n/* code from main that caused conflict */\n=======\n/* code from feature that caused conflict */\n>>>>>>\n```\n\n\nWhen Git encounters a conflict, it adds [<<<< ; >>>>]{.red} and [ ======= ]{.red} to highlight the parts that caused the conflict and need to be resolved.\n\n## Resolving conflicts in practice\n\n- Open the file in a text editor (for example Rstudio)\n- Decide which part of the code you need to keep in the final `main` branch\n- Remove the irrelevant code and the conflict indicators\n- Run `git add`  to stage the file/s and `git commit` to commit the changes: this will generate the merge commit.\n\n## Resolving the conflict\n\n![](images/conflict.png){fig-align=\"center\"}\n\n## Merging branches\n\n![](images/fastforward.png){fig-align=\"center\"}\n\n## Creating branches from Rstudio\n\n![](images/Rstudiobranch.png){fig-align=\"center\"}\n\n::: {.callout-important}\nWhen we create a branch using Rstudio the branch is created both in  the local and in the remote repository (at the same time.)\n:::\n\n## Keep refreshing Rstudio (Cloud)\n\nOtherwise some of your branches and changes might not be updated.\n\n![](images/refresh.png){fig-align=\"center\"}\n\n## Diff window in Rstudio \n\n![](images/diffwindow.png){fig-align=\"center\"}\n\n\n## Rstudio Demo\n\n![](images/paul-skorupskas-7KLa-xLbSXA-unsplash.jpg){fig-align=\"center\"}\n\n## Coming up...\n\n**After your tutorial this week:**\n\n[In the next weeks, we will be using VSCode]{.monash-green2}\n\n- To help us resolve conflicts\n- To have a nicer way for visualizing Git trees + much more!\n\n## Don't forget about Assignment 1!\n\n- For this first assignment your repository can be private. However, when you submit your assignment make sure you make it public.\n- Think that you will be able to show case this assignment on your GitHub account so that you can start building your projects portfolio.\n- Please come to any of the consultation hours if you have any questions.\n\n\n## Week 4 Lesson\n\n::: {.callout-important}\n## Summary\n\n* Learned more on creating reproducible reports:\n  - Referencing\n  - Talk about css files\n* More on Git:\n  - Branches\n* Solving Git merging conflicts\n* Install VSCode as a GUI to work with Git/GitHub and as a text editor for commits.\n\n:::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}